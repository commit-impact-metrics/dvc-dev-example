# Оценка технологического риска внедрения релизов ПО для ETL и DWH

## Оглавление

1. [Задача](##Задача)
2. [Исходный проект](#Исходный-проект-Commit-impact-metrics)
3. [Начало работы](##Начало-работы)
4. [TODO](#TODO)
5. [Состав команды и роли](##Состав-команды-и-роли)
6. [Состояние проекта](##Состояние-проекта)
7. [Вехи работы над проектом](##Вехи-работы-над-проектом)
8. [Используемые технологии](##Используемые-технологии)
9. [Архитектура](##Архитектура)
10. [Взаимодействие компонентов](##Взаимодействие-компонентов)
11. [Контакты](##Контакты)

## Задача

Разработать алгоритм (модель, методику) и программу для оценки технологического риска внедрений релизов программного обеспечения, предназначенного для выполнения процедур трансформации данных (ETL) и расчетов на витринах хранилища данных (DWH).

# Исходный проект Commit-impact-metrics

Источник: https://github.com/iterative/example-get-started.git

## Начало работы

```
python -m venv .venv
source .venv/bin/activate
pip install -r src/requirements.txt
```

пример использования
```
python -m cim 2-track-data
```
проведет сравнение текущей ветки с веткой 2-track-data. Результат запишет в output.

## TODO
1. Переопределить функции из cim/state, чтобы добавить более актуальные метрики сравнения;
2. Добавить конфиги;
3. Определить список поддерживаемых файлов. Неподдерживаемые игнорить при сравнении (.pkl сравнивать или нет? По какой метрике?)
4. Интеграция метрик качества данных в алгоритм оценки рисков. 
5. Разработка модели оценки рисков бизнес-процессов.
6. Тестирование и валидация алгоритма.  
7. Документация готового решения.


## Состав команды и роли

**Команда**: 37 МФТИ Сбер  
**Состав**:
- **Никита Ломов** — Team Lead  
- **Андрей Гриценко** — Разработчик  
  *Реализация обработки dvc.*
- **Анастасия Токарева** — Аналитик  
  *Подготовка алгоритма оценки риска изменения качества данных на базе изменений в dvc.*
- **Владимир Ульзутуев** — Аналитик  
  *Подготовка алгоритма оценки рисков нарушения бизнес-процессов, их простоя и срочности задач в релизе.*

## Состояние проекта

- **Готова программа** для сравнения веток в DVC.  
- **Готов анализ** и метрики для оценки качества данных (analysis/metrics).

## Вехи работы над проектом

- **Открытие хакатона** 02.12.2024 - Пройдена
- **Сбор команды** 03.12.2024 - Пройдена
- **Синк с командой и начало поиска решения** 04.12.2024 - Пройдена
- **Первая встреча с ментором** 09.12.2024 - Пройдена
- **Завершение поиска и распределение по ролям** 09.12.2024 - Пройдена
- **Первая версия программы и завершение анализа** 12.12.2024 - Пройдена
- **Оформление и промежуточная сдача работы** 13.12.2024 - Пройдена
- **Вторая встреча с ментором** 17.12.2024 - Пройдена
- **Доработки и формление** 18.12.2024 - Пройдена
- **Сдача работы** 19.12.2024 - Пройдена
- **Защита** 20.12.2024

## Используемые технологии

- **DVC** — ключевая технология для управления данными и их версионирования.
- **Python** — для разработки программного обеспечения.
- **pandas, numpy** — для анализа оценки изменений между коммитами или ветками.
- **Git** — для работы с репозиториями и ветками.

## Архитектура

Проект состоит из пяти основных компонентов:

### 1. **Основной модуль (`cim/__main__.py`)**
   - Точка входа для запуска программы через командную строку.
   - Разбирает аргументы командной строки для выбора типа анализа (сравнение веток или коммитов).
   - В зависимости от параметров вызывает функции для анализа веток или коммитов.

### 2. **Сравнение веток (`cim/branches.py`)**
   - Клонирует репозиторий в временную директорию.
   - Для каждой ветки находит последний коммит (HEAD).
   - Сравнивает коммиты с помощью модуля `cim/commits.py`.

### 3. **Анализ коммитов (`cim/commits.py`)**
   - Клонирует репозиторий и переключается на два коммита.
   - Собирает состояние файлов для каждого коммита.
   - Сравнивает эти состояния и вычисляет метрики изменений.
   - Сохраняет результаты в JSON-файлы.

### 4. **Работа с состоянием файлов (`cim/state.py`)**
   - Собирает информацию о файлах и подсчитывает строки в каждом файле.
   - Сравнивает два состояния файлов, генерируя метрики изменений (добавленные, удаленные строки).

### 5. **Вспомогательные утилиты (`cim/utils.py`)**
   - Клонирует репозиторий, сохраняет метрики в файлы, получает последние коммиты и подсчитывает строки в файлах.

## Взаимодействие компонентов

1. **Основной модуль** (`cim/__main__.py`) принимает аргументы командной строки и вызывает соответствующие функции для анализа.
2. Для **сравнения веток** вызывается функция из `cim/branches.py`, которая, в свою очередь, вызывает анализ коммитов через `cim/commits.py`.
3. Для **сравнения коммитов** используется функция `analyze_two_commits_with_cache` из `cim/commits.py`, которая выполняет клонирование репозитория, анализ файлов и вычисление метрик изменений.
4. **Состояния файлов** анализируются в `cim/state.py`, где подсчитываются строки в файлах и вычисляются различия.
5. Результаты сохраняются в JSON-файлы для дальнейшего анализа.

## Контакты

Для вопросов и предложений можно обращаться в TG @Loprima.